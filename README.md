# باشگاه نمایندگان استیل البرز - WordPress Plugin

## تغییرات نسخه 1.0.0

### ویژگی‌های جدید:
- **سیستم مدیریت کاربران**: ایجاد نقش‌های سفارشی (نماینده، مدیر نمایندگی، مدیر)
- **فرم ثبت سریال**: فرم دو ستونی برای ثبت سریال‌های محصول
- **سیستم کیف پول و امتیاز**: مدیریت کیف پول و امتیازات کاربران
- **پردازش پرداخت**: اتصال به درگاه‌های بانکی و پردازش تراکنش‌ها
- **انتقال وجه**: سرویس "دو طرفه" برای انتقال وجه از کیف پول
- **اعلان‌ها**: ارسال ایمیل و پیامک
- **API Manager**: مدیریت API های سروشان، بانک و جی‌بیت
- **پنل مدیریت**: داشبورد کامل برای مدیریت تمام بخش‌ها
- **درون‌ریزی داده‌ها**: سیستم پیشرفته برای درون‌ریزی فایل‌های CSV بزرگ (تا 30 مگابایت)
- **پردازش دسته‌ای**: پردازش فایل‌های بزرگ به صورت دسته‌ای با نوار پیشرفت
- **مدیریت گروه‌های محصول**: تنظیم و مدیریت گروه‌های محصول و پاداش‌ها

### بهبودهای فنی:
- **بهینه‌سازی حافظه**: مدیریت بهتر حافظه برای فایل‌های بزرگ
- **پردازش فایل‌های موقت**: تقسیم فایل‌های خیلی بزرگ به قطعات کوچکتر
- **مدیریت خطا**: سیستم جامع مدیریت خطا و گزارش‌دهی
- **مهاجرت خودکار دیتابیس**: اضافه شدن ستون‌های جدید به صورت خودکار
- **افزایش محدودیت‌های سرور**: تنظیم محدودیت‌های PHP برای فایل‌های بزرگ
- **راهنمایی خطا**: راهنمایی‌های تخصصی برای رفع مشکلات timeout

## نصب و راه‌اندازی

### پیش‌نیازها:
- WordPress 5.0 یا بالاتر
- PHP 7.4 یا بالاتر
- MySQL 5.7 یا بالاتر

### مراحل نصب:
1. فایل پلاگین را در پوشه `/wp-content/plugins/` آپلود کنید
2. پلاگین را از طریق پنل مدیریت وردپرس فعال کنید
3. به بخش "باشگاه استیل البرز" در منوی مدیریت بروید
4. تنظیمات اولیه را انجام دهید

## ویژگی‌های اصلی

### مدیریت کاربران
- ایجاد نقش‌های سفارشی: نماینده، مدیر نمایندگی، مدیر
- فرم ثبت کاربر بدون نیاز به افزونه‌های خارجی
- مدیریت کارمندان توسط مدیران نمایندگی
- فیلدهای سفارشی برای اطلاعات کاربران

### فرم ثبت سریال
- فرم دو ستونی با طراحی مدرن
- حفظ اطلاعات مشتری پس از ثبت
- پاک کردن فیلدهای محصول پس از ثبت
- اعتبارسنجی سریال از طریق API سروشان

### سیستم کیف پول و امتیاز
- کیف پول شخصی برای هر کاربر
- سیستم امتیازدهی
- تاریخچه تراکنش‌ها
- انتقال وجه بین کیف پول‌ها

### پردازش پرداخت
- اتصال به درگاه‌های بانکی
- پردازش امن تراکنش‌ها
- سیستم rollback برای تراکنش‌های ناموفق
- تأیید تراکنش‌ها

### انتقال وجه
- سرویس "دو طرفه" برای انتقال وجه
- تأیید توسط مدیران
- تاریخچه انتقال‌ها
- اعلان‌های خودکار

### اعلان‌ها
- ارسال ایمیل برای رویدادهای مختلف
- ارسال پیامک (نیاز به تنظیم SMS Gateway)
- قالب‌های قابل تنظیم
- مدیریت اعلان‌ها

### API Manager
- **سروشان**: تأیید سریال‌های محصول
- **بانک**: پردازش پرداخت‌ها
- **جی‌بیت**: احراز هویت کاربران

### پنل مدیریت
- داشبورد کامل با آمار و نمودارها
- مدیریت کاربران و نقش‌ها
- مدیریت کیف پول و امتیازات
- مدیریت پاداش‌ها و گروه‌های محصول
- تنظیمات پیشرفته

## درون‌ریزی داده‌ها

### ویژگی‌های جدید:
- **پشتیبانی از فایل‌های بزرگ**: تا 30 مگابایت
- **پردازش دسته‌ای**: تنظیم اندازه دسته (پیش‌فرض: 1000)
- **تقسیم فایل موقت**: برای فایل‌های بزرگ (>15MB) فایل به قطعات کوچکتر تقسیم می‌شود
- **نوار پیشرفت**: نمایش پیشرفت درون‌ریزی
- **مدیریت حافظه**: بهینه‌سازی برای فایل‌های بزرگ
- **گزارش خطا**: نمایش جزئیات خطاها

### نحوه استفاده:
1. به بخش "درون‌ریزی داده‌ها" بروید
2. فایل CSV را انتخاب کنید
3. اندازه دسته را تنظیم کنید (توصیه: 500-1000 برای فایل‌های بزرگ)
4. روی "شروع درون‌ریزی" کلیک کنید
5. منتظر تکمیل عملیات بمانید

### فرمت فایل CSV:
```
ID,عنوان,وضعیت,نام کاربری,مالک,استان,شهر,شماره تماس,شماره شبا,گروه,خریدار,کد ملی خریدار,شماره خریدار,سریال,تاریخ
```

### رفع مشکلات timeout:
اگر با خطای timeout مواجه شدید:
1. **کاهش اندازه دسته**: اندازه دسته را به 500 یا 1000 کاهش دهید
2. **تقسیم فایل**: فایل بزرگ را به چندین فایل کوچکتر تقسیم کنید
3. **تماس با مدیر سرور**: برای افزایش محدودیت‌های زمانی
4. **استفاده از فایل‌های کوچکتر**: فایل‌های کمتر از 10 مگابایت
5. **فایل‌های بزرگ**: برای فایل‌های بزرگ (>15MB) سیستم به صورت خودکار فایل را تقسیم می‌کند

## تنظیمات

### تنظیمات عمومی
- تنظیم نام و توضیحات پلاگین
- فعال/غیرفعال کردن ویژگی‌ها
- تنظیم محدودیت‌های سیستم

### تنظیمات API
- کلیدهای API سروشان، بانک و جی‌بیت
- تنظیمات اتصال
- تست اتصال

### تنظیمات اعلان‌ها
- تنظیمات SMTP برای ایمیل
- تنظیمات SMS Gateway
- قالب‌های پیام

### تنظیمات گروه‌های محصول
- مدیریت گروه‌های محصول
- تنظیم مبلغ پاداش برای هر گروه
- پاداش پیش‌فرض

## شورت‌کدها

### `[steelalborz_reward_form]`
فرم ثبت سریال و درخواست پاداش

### `[steelalborz_wallet]`
نمایش کیف پول کاربر

### `[steelalborz_points]`
نمایش امتیازات کاربر

### `[steelalborz_user_registration]`
فرم ثبت‌نام کاربر جدید

### `[steelalborz_manage_employees]`
مدیریت کارمندان (فقط برای مدیران)

## امنیت

### ویژگی‌های امنیتی:
- استفاده از Nonce برای امنیت AJAX
- اعتبارسنجی و sanitize کردن داده‌ها
- بررسی دسترسی‌ها
- محافظت در برابر SQL Injection
- رمزگذاری داده‌های حساس

### بهترین شیوه‌ها:
- استفاده از prepared statements
- اعتبارسنجی ورودی‌ها
- محدود کردن دسترسی‌ها
- ثبت رویدادهای امنیتی

## پشتیبانی

### گزارش مشکلات:
- بررسی لاگ‌های وردپرس
- بررسی خطاهای PHP
- تست با فایل‌های کوچک
- بررسی تنظیمات سرور

### راهنمایی‌های عمومی:
- اطمینان از نصب صحیح
- بررسی دسترسی‌های فایل
- تست با مرورگرهای مختلف
- بررسی سازگاری با افزونه‌های دیگر

## مجوز

این پلاگین تحت مجوز GPL v2 یا بالاتر منتشر شده است.

## تغییرات نسخه 1.0.0

### ویژگی‌های جدید:
- **سیستم درون‌ریزی پیشرفته**: پشتیبانی از فایل‌های تا 30 مگابایت
- **پردازش دسته‌ای**: تنظیم اندازه دسته برای بهینه‌سازی عملکرد
- **نوار پیشرفت**: نمایش پیشرفت درون‌ریزی به صورت زنده
- **پردازش فایل‌های موقت**: تقسیم فایل‌های خیلی بزرگ به قطعات کوچکتر
- **مدیریت حافظه**: بهینه‌سازی حافظه برای فایل‌های بزرگ
- **گزارش خطای پیشرفته**: نمایش جزئیات کامل خطاها
- **مهاجرت خودکار دیتابیس**: اضافه شدن ستون‌های جدید به صورت خودکار
- **افزایش محدودیت‌های سرور**: تنظیم محدودیت‌های PHP برای فایل‌های بزرگ
- **راهنمایی خطا**: راهنمایی‌های تخصصی برای رفع مشکلات timeout

### بهبودهای فنی:
- **بهینه‌سازی عملکرد**: کاهش استفاده از حافظه و CPU
- **مدیریت خطای جامع**: سیستم کامل مدیریت خطا و گزارش‌دهی
- **پشتیبانی از فایل‌های بزرگ**: تا 30 مگابایت با پردازش بهینه
- **راهنمایی کاربر**: راهنمایی‌های تخصصی برای رفع مشکلات
- **سازگاری بهتر**: سازگاری با انواع مختلف سرورها 